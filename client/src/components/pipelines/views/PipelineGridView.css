/* Overrides to ensure pipeline grid uses a clear min cell and prevents overflow */
[data-testid="pipeline-grid"] {
    grid-template-columns: repeat(auto-fit, minmax(var(--min-cell, 120px), 1fr)) !important;
    grid-auto-rows: var(--min-cell, 120px) !important;
    gap: 8px !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
}

/* Ensure each cell fills its grid area */
[data-testid="pipeline-grid"]>* {
    width: 100% !important;
    height: var(--min-cell, 120px) !important;
    min-height: var(--min-cell, 120px) !important;
    box-sizing: border-box !important;
}

/* Sidebar: ensure vertical scrolling and not hidden */
.w-80.overflow-hidden {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
}

/* Make pipeline scroll wrapper hide horizontal overflow */
[data-testid="pipeline-scroll"] {
    overflow-x: hidden !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    /* Do not force a large minimum height â€” allow the parent panel to limit via max-height */
    min-height: 0 !important;
    height: auto !important;
    /* keep the timeline visually bounded and scrollable to prevent growth on browser zoom */
    max-height: 100% !important;
    overflow-y: auto !important;
}

/* Lock the pipeline panel height so browser zoom can't make it grow unexpectedly */
[data-testid="pipeline-panel"] {
    /* use viewport-based height but cap it in pixels to avoid zoom-driven growth */
    height: min(72vh, 720px) !important;
    max-height: 720px !important;
    min-height: 420px !important;
    overflow: hidden !important;
    display: flex !important;
    flex-direction: column !important;
}

/* Ensure the virtualized grid wrapper cannot overflow horizontally */
[data-testid="pipeline-grid-wrapper"] {
    width: 100% !important;
    overflow-x: hidden !important;
    box-sizing: border-box !important;
    /* make sure the react-window canvas cannot exceed the available width */
    max-width: 100% !important;
}

/* Small safety: ensure last column's right edge remains visible (prevents '+' from being clipped) */
.pipeline-cell {
    box-sizing: border-box;
    padding-right: 6px;
    /* small extra spacing inside cells */
}

/* Optimize cells rendering to minimize repaints */
[data-testid="pipeline-grid"]>* {
    will-change: transform, opacity;
}

.pipeline-cell {
    contain: layout size paint;
    will-change: transform, opacity;
    transform: translateZ(0);
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: stretch;
    box-sizing: border-box;
    padding: 8px;
    height: 100%;
    min-height: var(--min-cell, 96px);
    overflow: hidden;
}

.pipeline-cell .truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Marquee selection (click-drag depuis le vide) */
.pipeline-marquee {
    box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6), inset 0 0 0 1px rgba(130, 180, 255, 0.08);
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
    transition: none !important;
}