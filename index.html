<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="Composition, pr√©visualisation et exportation de reviews produits cannabis. Communaut√© et partage d'expertise." />
  <title>üìë Reviews Maker </title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Manrope:wght@400;500;600;700&display=swap"
    rel="stylesheet" />
  <!-- Cache-bust param added to ensure updated CSS is fetched after deploys -->
  <link rel="stylesheet" href="styles.css?v=20251029" />
  <link rel="stylesheet" href="ui/ui-base.css" />
  <link rel="icon" type="image/png" href="ink/logo.png" />
</head>

<body class="home-page">
  <div class="app-shell">
    <header class="top-nav" role="banner">
      <div class="brand" role="button" tabindex="0" aria-label="Accueil">
        <span class="brand-mark" aria-hidden="true"><img src="ink/logo.png" alt=""
            style="width:22px;height:22px;object-fit:contain;border-radius:4px" /></span>
        <div class="brand-text">
          <strong>Reviews Maker</strong>
          <span>Analyse de qualit√©</span>
        </div>
      </div>
      <div class="top-nav-status">
        <div class="nav-actions">
          <span class="pill-btn" id="openTips" title="Afficher les raccourcis et astuces" tabindex="0" role="button">
            <span aria-hidden="true">üí°</span>
            Astuce
          </span>
        </div>
      </div>
    </header>

    <main class="workspace home-workspace" role="main">
      <!-- Section Hero -->
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">Composez une review premium</h1>
          <p class="hero-subtitle">S√©lectionnez le type de produit pour activer les blocs adapt√©s.</p>

          <!-- S√©lection du type de produit -->
          <div class="type-selector" role="list">
            <button type="button" class="type-card" data-type="Hash" role="listitem">
              <span class="type-icon" aria-hidden="true">üç´</span>
              <div class="type-content">
                <span class="type-title">Hash</span>
                <span class="type-caption">bubble hash, WPFF, dry sift, etc.</span>
              </div>
            </button>
            <button type="button" class="type-card" data-type="Fleur" role="listitem">
              <span class="type-icon" aria-hidden="true">üçÉ</span>
              <div class="type-content">
                <span class="type-title">Fleur</span>
                <span class="type-caption">Indoor, outdoor, greenhouse‚Ä¶</span>
              </div>
            </button>
            <button type="button" class="type-card" data-type="Concentr√©" role="listitem">
              <span class="type-icon" aria-hidden="true">üçØ</span>
              <div class="type-content">
                <span class="type-title">Concentr√©</span>
                <span class="type-caption">Rosin, BHO, live resin, etc.</span>
              </div>
            </button>
            <button type="button" class="type-card" data-type="Comestible" role="listitem">
              <span class="type-icon" aria-hidden="true">üç¨</span>
              <div class="type-content">
                <span class="type-title">Comestible</span>
                <span class="type-caption">P√¢tisserie, boisson, huile‚Ä¶</span>
              </div>
            </button>
          </div>

          <!-- Actions rapides retir√©es: la gestion des brouillons se fait via la galerie -->
        </div>
      </section>

      <!-- Galerie publique des reviews -->
      <section class="library-section">
        <div class="section-header">
          <h2 class="section-title">
            <span aria-hidden="true">üñºÔ∏è</span>
            Galerie publique
          </h2>
        </div>
        <!-- Galerie publique compacte -->
        <div class="compact-library" id="compactLibrary">
          <div class="compact-library-empty" id="compactLibraryEmpty" style="display: none;">
            <span class="empty-icon" aria-hidden="true">üìù</span>
            <p>Aucune review publique encore cr√©√©e</p>
            <span class="empty-hint">Les reviews publiques appara√Ætront ici</span>
          </div>
          <div class="compact-library-list" id="compactLibraryList"></div>
          <div class="library-actions-below">
            <button type="button" class="btn btn-outline" id="showMoreLibrary">Voir plus</button>
          </div>
        </div>
      </section>
    </main>

    <!-- Modal Biblioth√®que compl√®te -->
    <div class="modal" id="libraryModal" style="display: none;">
      <div class="modal-overlay" id="libraryModalOverlay"></div>
      <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="libraryTitle">
        <div class="modal-header">
          <div style="display:flex;align-items:center;gap:12px;">
            <button type="button" class="btn btn-ghost" id="libraryBackToAccount" style="display:none;">‚Üê
              Retour</button>
            <h2 id="libraryTitle">üñºÔ∏è Galerie publique</h2>
          </div>
          <button type="button" class="modal-close" id="closeLibrary" aria-label="Fermer">
            <span aria-hidden="true">√ó</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="search-bar">
            <input type="text" id="librarySearch" placeholder="Rechercher par nom, vari√©t√©, farm..."
              class="search-input">
          </div>
          <div class="library-grid" id="libraryGrid">
            <!-- Reviews compl√®tes seront g√©n√©r√©es ici -->
          </div>
          <div class="library-empty" id="libraryEmpty" style="display: none;">
            <span class="empty-icon" aria-hidden="true">üìö</span>
            <p>Aucune review trouv√©e</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Astuces -->
    <div class="modal" id="tipsModal" style="display: none;">
      <div class="modal-overlay" id="tipsModalOverlay"></div>
      <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="tipsTitle">
        <div class="modal-header">
          <h2 id="tipsTitle">Raccourcis & Astuces</h2>
          <button type="button" class="modal-close" id="closeTips" aria-label="Fermer">
            <span aria-hidden="true">√ó</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="tips-content">
            <div class="tip-group">
              <h3>üéØ Navigation</h3>
              <ul>
                <li><kbd>Tab</kbd> / <kbd>Shift</kbd> + <kbd>Tab</kbd> : Navigation entre les champs</li>
                <li><kbd>√âchap</kbd> : Fermer les modales</li>
                <li>Cliquer sur le logo : Retour √† l'accueil</li>
              </ul>
            </div>
            <div class="tip-group">
              <h3>‚ú® Fonctionnalit√©s</h3>
              <ul>
                <li>Aper√ßu en temps r√©el</li>
                <li>Export haute qualit√© en PNG</li>
              </ul>
            </div>
            <div class="tip-group">
              <h3>üìù Bonnes pratiques</h3>
              <ul>
                <li>Remplissez au minimum les sections obligatoires</li>
                <li>Ajoutez une photo pour un rendu optimal</li>
                <li>Utilisez des descriptions d√©taill√©es</li>
                <li>Sauvegardez r√©guli√®rement vos reviews importantes</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Connexion / Authentification -->
  <!-- Redesigned Account Modal (same structure as in review.html) -->
  <div class="account-overlay" id="accountModalOverlay"></div>
  <div id="accountModal" data-backdrop="none" aria-hidden="true" hidden>
    <div class="account-dialog" role="dialog" aria-modal="true" aria-labelledby="accountTitle">
      <div class="account-header">
        <h3 id="accountTitle">Mon compte</h3>
        <div style="display:flex;gap:8px;align-items:center;">
          <button type="button" class="btn btn-ghost" id="openAccountSettings" title="Param√®tres">‚öôÔ∏è Param√®tres</button>
          <button type="button" class="modal-close" id="closeAccountModal" aria-label="Fermer">‚úï</button>
        </div>
      </div>
      <div class="account-body">
        <div class="account-left">
          <div class="account-profile">
            <div class="account-avatar">üë§</div>
            <div class="account-meta">
              <div id="accountEmail">‚Äî</div>
              <div class="sub">Membre Reviews Maker</div>
            </div>
          </div>
          <div class="stats-grid" aria-hidden="false">
            <div class="stat-card">
              <div class="num" id="accountTotal">0</div>
              <div class="label">Total</div>
            </div>
            <div class="stat-card">
              <div class="num" id="statPublic">0</div>
              <div class="label">Public</div>
            </div>
            <div class="stat-card">
              <div class="num" id="statPrivate">0</div>
              <div class="label">Priv√©</div>
            </div>
          </div>
          <div style="margin-top:10px;">
            <h4 class="section-title">R√©partition par type</h4>
            <div id="accountStatsByType" class="account-stats-by-type"></div>
          </div>
        </div>
        <div class="account-right">
          <div class="panel">
            <div style="display:flex;align-items:center;justify-content:space-between;">
              <h4 class="section-title">Actions</h4>
            </div>
            <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px;"><button class="btn btn-outline"
                id="openLibraryFromAccount">Ma biblioth√®que</button><button class="btn btn-outline"
                id="accountDisconnect">Se d√©connecter</button></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="authModal" style="display: none;">
    <div class="modal-overlay" id="authModalOverlay"></div>
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <div class="modal-header">
        <h2 id="authTitle">Connexion</h2>
        <button type="button" class="modal-close" id="closeAuth" aria-label="Fermer">
          <span aria-hidden="true">√ó</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="auth-content">
          <p class="auth-description">Liez votre compte pour synchroniser vos reviews sur le serveur et y acc√©der depuis
            n'importe quel appareil.</p>

          <!-- √âtape 1: Demande d'email -->
          <div id="authStepEmail" class="auth-step">
            <div class="form-group">
              <label for="authEmailInput">Adresse email</label>
              <input type="email" id="authEmailInput" class="input" placeholder="votre@email.com" />
            </div>
            <div class="auth-actions">
              <button type="button" class="btn btn-primary" id="authSendCode">Envoyer le code</button>
            </div>
          </div>

          <!-- √âtape 2: V√©rification du code -->
          <div id="authStepCode" class="auth-step" style="display:none;">
            <p class="auth-info">Un code de v√©rification a √©t√© envoy√© √† <strong id="authEmailDisplay"></strong></p>
            <div class="form-group">
              <label for="authCodeInput">Code de v√©rification</label>
              <input type="text" id="authCodeInput" class="input" placeholder="123456" maxlength="6" />
            </div>
            <div class="auth-actions">
              <button type="button" class="btn btn-outline" id="authBack">Retour</button>
              <button type="button" class="btn btn-primary" id="authVerifyCode">V√©rifier</button>
            </div>
            <p class="auth-help">Code non re√ßu ? <button type="button" class="link-btn"
                id="authResendCode">Renvoyer</button></p>
          </div>

          <!-- √âtape 3: Connect√© -->
          <div id="authStepConnected" class="auth-step" style="display:none;">
            <div class="account-profile" style="margin-bottom:10px;">
              <div class="account-avatar">üë§</div>
              <div class="account-meta">
                <div id="authConnectedEmail" class="email">‚Äî</div>
                <div class="sub">Membre Reviews Maker</div>
              </div>
            </div>
            <div class="stats-grid" style="margin-bottom:10px;">
              <div class="stat-card">
                <div class="num" id="authConnTotal">0</div>
                <div class="label">Total</div>
              </div>
              <div class="stat-card">
                <div class="num" id="authConnPublic">0</div>
                <div class="label">Public</div>
              </div>
              <div class="stat-card">
                <div class="num" id="authConnPrivate">0</div>
                <div class="label">Priv√©</div>
              </div>
            </div>
            <div style="margin-top:10px;">
              <h4 class="section-title">R√©partition par type</h4>
              <div id="authConnByType" class="account-stats-by-type"></div>
            </div>
            <div class="auth-actions" style="margin-top:12px;">
              <button type="button" class="btn btn-outline" id="authOpenLibrary">Ma biblioth√®que</button>
              <button type="button" class="btn btn-outline" id="authDisconnect">Se d√©connecter</button>
            </div>
          </div>

          <div class="auth-status" id="authStatus" style="display:none;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Public profile modal removed from index.html ‚Äî profile is accessible via floating auth button only -->

  <!-- Public profile modal (read-only) -->
  <div class="modal" id="publicProfileModal" style="display:none;">
    <div class="modal-overlay" id="publicProfileOverlay"></div>
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="publicProfileTitle">
      <div class="modal-header">
        <h2 id="publicProfileTitle">Profil public</h2>
        <button type="button" class="modal-close" id="closePublicProfile" aria-label="Fermer">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="account-profile" style="margin-bottom:10px;">
          <div class="account-avatar">üë§</div>
          <div class="account-meta">
            <div id="publicProfileEmail">‚Äî</div>
            <div class="sub">Membre Reviews Maker</div>
          </div>
        </div>
        <div class="stats-grid" style="margin-bottom:10px;">
          <div class="stat-card">
            <div class="num" id="publicTotal">0</div>
            <div class="label">Total</div>
          </div>
          <div class="stat-card">
            <div class="num" id="publicPublic">0</div>
            <div class="label">Public</div>
          </div>
          <div class="stat-card">
            <div class="num" id="publicPrivate">0</div>
            <div class="label">Priv√©</div>
          </div>
        </div>
        <div style="margin-top:10px;">
          <h4 class="section-title">R√©partition par type</h4>
          <div id="publicByType" class="account-stats-by-type"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bouton flottant de connexion -->
  <button type="button" class="floating-auth-btn" id="floatingAuthBtn" title="Lier mon compte">
    <span aria-hidden="true">üîó</span>
  </button>

  <!-- Preview-only Overlay for home page (to visualize a review from gallery) -->
  <div id="previewOverlay" class="preview-overlay" hidden></div>
  <div id="previewModal" class="preview-modal" role="dialog" aria-modal="true" aria-label="Aper√ßu de la review" hidden>
    <header class="preview-modal-header">
      <h3>Aper√ßu</h3>
      <div class="actions">
        <button type="button" class="btn btn-secondary btn-sm" id="downloadPreviewPng">T√©l√©charger l'image</button>
        <button type="button" class="pill-btn" id="closePreviewModal" title="Fermer">‚úï</button>
      </div>
    </header>
    <div class="preview-modal-body">
      <div id="previewModalContent" class="review-content"></div>
    </div>
  </div>

  <!-- Confirmation de suppression (global) -->
  <div class="modal small" id="confirmDeleteModal" style="display:none;" aria-hidden="true">
    <div class="modal-overlay" id="confirmDeleteOverlay"></div>
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="confirmDeleteTitle">
      <div class="modal-header">
        <h2 id="confirmDeleteTitle">Confirmer la suppression</h2>
        <button type="button" class="modal-close" id="closeConfirmDelete" aria-label="Fermer">‚úï</button>
      </div>
      <div class="modal-body">
        <p>√ätes-vous s√ªr(e) de vouloir supprimer cette review ? Cette action est irr√©versible.</p>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-outline" id="cancelDelete">Annuler</button>
        <button type="button" class="btn btn-danger" id="confirmDelete">Supprimer</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="scripts/logger.js"></script>
  <script src="app.js?v=2025-10-24-prodfix-1"></script>
  <!-- Feedback widget removed -->
</body>

</html>